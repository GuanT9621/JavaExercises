# MVCC - Multiversion Concurrency Control - 多版本并发控制
## 行记录的隐藏列
* row_id   : 隐藏的行 ID ,用来生成默认的聚集索引。如果创建数据表时没指定聚集索引，这时 InnoDB 就会用这个隐藏 ID 来创建聚集索引。采用聚集索引的方式可以提升数据的查找效率。
* trx_id   : 操作这个数据事务 ID ，也就是最后一个对数据插入或者更新的事务 ID 。
* roll_ptr : 回滚指针，指向这个记录的 Undo Log 信息。

## 示例
当事务1更改该行的值时，会进行如下操作：
1. 用排他锁锁定该行
2. 记录redo log
3. 把该行修改前的值Copy（可以理解成Copy，不要纠结前面说反向更新这里说复制，原理是一样的）到undo log，即上图中下面的行
4. 修改当前行的值，填写事务编号，使回滚指针指向undo log中的修改前的行。    

事务2修改该行的值
1. 与事务1相同，此时undo log，中有有两行记录，并且通过回滚指针连在一起。
这些通过回滚指针联系起来的行相当于是数据的多个快照，从而实现MVCC的一致性非锁定读了。